#!/bin/sh /etc/rc.common

START=95
STOP=10
USE_PROCD=1

DB_PATH="/var/lib/cookie-tracker/cookies.db"

start_service() {
	local enabled
	config_load cookie-tracker
	config_get enabled main enabled '0'

	[ "$enabled" = "1" ] || return 0

	# Initialize database if needed
	/usr/sbin/cookie-trackerctl init 2>/dev/null

	logger -t cookie-tracker "Cookie Tracker service started"
}

stop_service() {
	logger -t cookie-tracker "Cookie Tracker service stopped"
}

reload_service() {
	# Reload tracker rules from UCI
	/usr/sbin/cookie-trackerctl reload
}

service_triggers() {
	procd_add_reload_trigger "cookie-tracker"
}
